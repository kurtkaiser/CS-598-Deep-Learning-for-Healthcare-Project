2022-05-08 09:00:35,793 - INFO - Config:
2022-05-08 09:00:35,793 - INFO - {
    "L2_regularisation": 0,
    "alpha": 100,
    "base_dir": "models/experiments/eICU/LoS/LSTM",
    "batch_size": 512,
    "batch_size_test": 32,
    "batchnorm": "mybatchnorm",
    "bidirectional": false,
    "channelwise": false,
    "dataset": "eICU",
    "diagnosis_size": 64,
    "disable_cuda": false,
    "exp_name": "LSTM",
    "hidden_size": 128,
    "intermediate_reporting": false,
    "labs_only": false,
    "last_linear_size": 17,
    "learning_rate": 0.00129,
    "loss": "msle",
    "lstm_dropout_rate": 0.2,
    "main_dropout_rate": 0.45,
    "mode": "train",
    "model_type": "tpc",
    "n_epochs": 10,
    "n_layers": 2,
    "name": "LSTM",
    "no_diag": false,
    "no_exp": false,
    "no_labs": false,
    "no_mask": false,
    "percentage_data": 100.0,
    "save_results_csv": false,
    "seed": 147321536,
    "shuffle_train": false,
    "sum_losses": true,
    "task": "LoS"
}
2022-05-08 09:00:39,156 - INFO - Experiment set up.
2022-05-08 09:00:39,179 - INFO - BaseLSTM(
  (relu): ReLU()
  (sigmoid): Sigmoid()
  (hardtanh): Hardtanh(min_val=0.020833333333333332, max_val=100)
  (lstm_dropout): Dropout(p=0.2, inplace=False)
  (main_dropout): Dropout(p=0.45, inplace=False)
  (msle_loss): MSLELoss(
    (squared_error): MSELoss()
  )
  (mse_loss): MSELoss(
    (squared_error): MSELoss()
  )
  (bce_loss): BCELoss()
  (empty_module): EmptyModule()
  (lstm): LSTM(176, 128, num_layers=2, dropout=0.2)
  (diagnosis_encoder): Linear(in_features=293, out_features=64, bias=True)
  (bn_diagnosis_encoder): MyBatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_los): Linear(in_features=257, out_features=17, bias=True)
  (point_mort): Linear(in_features=257, out_features=17, bias=True)
  (bn_point_last_los): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (bn_point_last_mort): MyBatchNorm1d(17, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (point_final_los): Linear(in_features=17, out_features=1, bias=True)
  (point_final_mort): Linear(in_features=17, out_features=1, bias=True)
)
2022-05-08 09:16:15,583 - INFO - Custom bins confusion matrix:
2022-05-08 09:16:15,583 - INFO - [[895311 950987 142509  53419  25568  13526   7839   4576   7921   1347]
 [367551 588279 139498  63301  32875  18235  10394   6167  10559   1592]
 [164938 347743 111083  56666  31439  17966  10571   6595  11245   1747]
 [ 82834 217097  85792  47605  27786  16453  10001   6124  10568   1770]
 [ 47254 142920  66118  39370  23597  14247   8804   5526   9791   1649]
 [ 29537  98716  51452  32509  20024  12317   7732   5056   9197   1515]
 [ 19086  71393  41528  27086  17154  10531   6829   4359   8034   1440]
 [ 12695  52800  33350  22762  14556   9332   5820   3749   7304   1373]
 [ 31090 151944 108202  77093  51536  33246  21510  14279  27518   5408]
 [ 15721  78616  67516  53548  37758  25458  17117  11698  23917   5479]]
2022-05-08 09:16:21,518 - INFO - Epoch: 0 | Train Loss: 110.1629
2022-05-08 09:19:06,667 - INFO - Custom bins confusion matrix:
2022-05-08 09:19:06,668 - INFO - [[200028 200811  29185  10765   5281   2155   1068    430    219      0]
 [ 73825 126813  32777  16310   8127   3301   1360    517    212      0]
 [ 30779  73486  26854  15863   8686   3594   1330    587    213      0]
 [ 15079  43813  20195  14257   8130   3237   1279    521    276      0]
 [  7998  27554  15243  12013   7503   3264   1204    511    252      0]
 [  4809  18908  12242  10025   6277   3057   1141    378    311      0]
 [  3236  12445   9798   8374   5201   2672   1076    374    284      0]
 [  2114   9254   7564   6882   4853   2431    984    266    277      0]
 [  4032  25318  25605  24732  17499   8174   3542   1574    720      0]
 [  1907  13560  15476  16865  11640   6462   3469   1547    762      0]]
2022-05-08 09:19:08,221 - INFO - Epoch: 0 | Validation Loss: 100.3009
2022-05-08 09:34:02,474 - INFO - Custom bins confusion matrix:
2022-05-08 09:34:02,475 - INFO - [[977729 879122 136969  51577  24509  12815   7350   4279   7450   1203]
 [372313 562252 149315  69329  35738  19407  11048   6556  10891   1602]
 [160103 326184 119295  64576  35643  20468  12108   7444  12294   1878]
 [ 77568 197948  91388  54486  32124  19125  11466   7336  12555   2034]
 [ 42665 126948  69008  44945  27637  16963  10620   6568  11935   1987]
 [ 25946  85451  53198  36691  23718  14805   9369   5872  11037   1968]
 [ 16382  59888  42418  30678  20083  12946   8199   5142   9976   1728]
 [ 10417  43139  33552  25579  17237  10909   7188   4797   9207   1716]
 [ 23168 117783 104675  85683  60539  40903  27513  18139  35979   7444]
 [ 10080  54486  61773  56801  43752  31357  21677  15336  33446   8120]]
2022-05-08 09:34:08,286 - INFO - Epoch: 1 | Train Loss: 100.6549
2022-05-08 09:36:53,165 - INFO - Custom bins confusion matrix:
2022-05-08 09:36:53,166 - INFO - [[194762 201889  31048  11940   5813   2524   1318    444    204      0]
 [ 67831 127720  34068  18113   9223   3932   1599    521    235      0]
 [ 27786  72249  27439  16833  10186   4453   1538    658    250      0]
 [ 13894  42310  19415  14946   9654   4170   1338    751    309      0]
 [  7361  26075  14610  12244   8906   3981   1435    596    334      0]
 [  4414  17787  11366  10160   7397   3675   1404    572    373      0]
 [  3025  11508   8922   8519   6135   3099   1332    605    315      0]
 [  2025   8381   6841   7058   5463   2947   1231    387    292      0]
 [  3984  22459  22353  24786  20210  10039   4656   1897    812      0]
 [  2080  11788  13241  15769  13930   7699   4265   2074    842      0]]
2022-05-08 09:36:54,780 - INFO - Epoch: 1 | Validation Loss: 97.1372
2022-05-08 09:51:48,893 - INFO - Custom bins confusion matrix:
2022-05-08 09:51:48,893 - INFO - [[985051 873626 136754  50994  24105  12549   7223   4195   7243   1263]
 [366216 565052 152139  69764  35570  19463  11105   6577  10877   1688]
 [154501 325340 122684  66156  36530  20785  12090   7386  12499   2022]
 [ 73644 196287  93895  55590  32979  19610  11667   7298  12887   2173]
 [ 40002 124757  70896  45766  28246  17184  10634   6832  12708   2251]
 [ 23894  83013  54092  37553  24644  15259   9712   6060  11710   2118]
 [ 14931  57896  42289  31492  20820  13291   8565   5520  10594   2042]
 [  9377  40751  33813  26136  17762  11672   7546   4973   9802   1909]
 [ 20292 108365 103863  87626  63105  42848  28736  19380  39289   8322]
 [  8204  48688  59345  57091  44815  32624  23109  16438  36454  10060]]
2022-05-08 09:51:54,904 - INFO - Epoch: 2 | Train Loss: 97.6871
2022-05-08 09:54:40,225 - INFO - Custom bins confusion matrix:
2022-05-08 09:54:40,226 - INFO - [[209180 186968  31281  12283   5623   2471   1282    534    320      0]
 [ 74102 120345  34248  18722   9208   4068   1592    571    386      0]
 [ 30475  68372  27672  17373  10161   4587   1672    613    467      0]
 [ 14998  40126  19692  15287   9636   4310   1480    674    584      0]
 [  8005  24861  14557  12518   8899   3995   1505    623    579      0]
 [  4623  17082  11423  10132   7393   3694   1599    660    542      0]
 [  3133  10985   8948   8544   6043   3119   1556    634    498      0]
 [  2073   8028   6862   6991   5302   3096   1386    492    395      0]
 [  4270  21354  21546  24998  19599  11006   4900   2078   1445      0]
 [  2226  11078  12836  15791  13352   8150   4289   2563   1403      0]]
2022-05-08 09:54:41,815 - INFO - Epoch: 2 | Validation Loss: 95.3958
2022-05-08 10:09:35,546 - INFO - Custom bins confusion matrix:
2022-05-08 10:09:35,546 - INFO - [[1004261  857339  135124   50167   24026   12592    6994    4337    6958
     1205]
 [ 367415  560262  154469   70994   36032   19489   11006    6535   10633
     1616]
 [ 152720  322536  124603   67281   37043   20979   12519    7555   12782
     1975]
 [  72064  192581   95690   57057   33932   19939   11880    7558   13230
     2099]
 [  38921  121202   71878   46809   29378   17874   11120    7015   12766
     2313]
 [  23191   79768   54874   38522   25016   15809    9961    6510   12134
     2270]
 [  14074   55107   43175   31953   21619   13731    8865    5716   11111
     2089]
 [   8681   38579   34105   26726   18405   12070    7780    5267   10105
     2023]
 [  18613  101211  102857   88582   64956   44292   29862   20464   41989
     9000]
 [   7282   43615   57218   56678   45720   33815   24116   17424   40038
    10922]]
2022-05-08 10:09:41,514 - INFO - Epoch: 3 | Train Loss: 95.4649
2022-05-08 10:12:26,681 - INFO - Custom bins confusion matrix:
2022-05-08 10:12:26,681 - INFO - [[206866 183291  34408  13857   6414   2797   1317    573    419      0]
 [ 71605 116830  36419  20206  10580   4666   1739    707    490      0]
 [ 29158  65836  27825  18774  11145   5219   2124    761    550      0]
 [ 14459  38016  19644  15950  10564   4793   1829    878    654      0]
 [  7724  23026  14522  13135   9480   4339   1880    747    689      0]
 [  4552  15791  11135  10547   7850   3911   1965    722    675      0]
 [  3066  10112   8634   8781   6316   3556   1672    681    642      0]
 [  2083   7345   6636   7007   5504   3463   1585    548    454      0]
 [  4150  19596  20007  24871  21266  11593   5714   2271   1728      0]
 [  2121  10129  11686  15992  14059   8697   4534   2661   1809      0]]
2022-05-08 10:12:28,242 - INFO - Epoch: 3 | Validation Loss: 94.7075
2022-05-08 10:27:23,713 - INFO - Custom bins confusion matrix:
2022-05-08 10:27:23,714 - INFO - [[1018927  846277  133778   49611   23249   12162    6785    4096    6919
     1199]
 [ 368402  559516  156065   70469   35519   19190   10892    6311   10373
     1714]
 [ 151692  320426  127144   67819   37067   21095   12314    7496   12869
     2071]
 [  70888  191034   97011   57897   34340   19682   12157    7545   13224
     2252]
 [  37740  119502   72917   47712   29055   18073   11182    7208   13474
     2413]
 [  22117   78317   55201   39283   25400   16162   10081    6653   12360
     2481]
 [  13450   53431   43012   32670   21867   14320    9034    5962   11338
     2356]
 [   8195   37142   33757   26757   18828   12506    8192    5329   10702
     2333]
 [  17464   95018  101325   88658   65913   45505   31217   21568   44904
    10254]
 [   6649   39377   53437   55116   45655   34651   25320   18742   44282
    13599]]
2022-05-08 10:27:29,729 - INFO - Epoch: 4 | Train Loss: 93.5351
2022-05-08 10:30:14,894 - INFO - Custom bins confusion matrix:
2022-05-08 10:30:14,894 - INFO - [[210440 181799  32989  12882   6270   2863   1370    697    628      4]
 [ 72410 117384  35784  19200   9995   4806   2100    858    703      2]
 [ 29588  66170  27438  17876  10903   5172   2361   1129    755      0]
 [ 14721  38361  19343  15235   9711   5232   2169   1060    936     19]
 [  7830  23373  14325  12627   8613   4638   2238    983    900     15]
 [  4635  16121  10812  10200   7104   4309   2003   1033    931      0]
 [  3170  10272   8570   8151   6008   3599   1934    865    891      0]
 [  2202   7415   6569   6516   5217   3529   1783    766    628      0]
 [  4415  20169  19544  22914  19613  12521   6494   3081   2445      0]
 [  2275  10522  11361  14502  13544   8652   4977   3158   2697      0]]
2022-05-08 10:30:16,477 - INFO - Epoch: 4 | Validation Loss: 94.1516
2022-05-08 10:47:09,492 - INFO - Custom bins confusion matrix:
2022-05-08 10:47:09,493 - INFO - [[1034658  831972  133890   49224   22872   11918    6476    3965    6764
     1264]
 [ 370761  556128  157266   70850   35388   18904   10654    6391   10493
     1616]
 [ 151230  318263  128869   68888   37143   20953   12163    7435   12854
     2195]
 [  70149  188309   98559   59348   34202   20115   11987    7548   13443
     2370]
 [  36504  116934   74549   48388   29926   18351   11203    7361   13447
     2613]
 [  21236   76098   56392   39812   25783   16086   10350    6682   12888
     2728]
 [  12944   51020   44013   33377   22097   14118    9214    6049   11975
     2633]
 [   7629   35510   34007   27319   19123   12516    8383    5494   11173
     2587]
 [  16277   89101  100256   88569   66072   46674   32363   22298   48054
    12162]
 [   5901   35579   50994   53574   45239   34594   26477   19391   48679
    16400]]
2022-05-08 10:47:15,576 - INFO - Epoch: 5 | Train Loss: 91.7753
2022-05-08 10:50:17,417 - INFO - Custom bins confusion matrix:
2022-05-08 10:50:17,417 - INFO - [[208469 182076  34539  12988   6079   2829   1695    621    635     11]
 [ 70717 117665  37646  18790   9703   4875   2151    859    826     10]
 [ 28842  65867  28896  17611  10220   5494   2434   1060    967      1]
 [ 14408  38008  20336  14657   9754   5260   2205   1113   1032     14]
 [  7713  23109  14885  12250   8592   4487   2378   1134    992      2]
 [  4619  15704  11515   9685   7127   4206   2124   1158   1010      0]
 [  3098  10212   8750   7946   5957   3519   2041    990    947      0]
 [  2170   7297   6794   6380   5089   3366   1973    845    711      0]
 [  4683  19612  20288  22309  18840  12611   6776   3284   2793      0]
 [  2320  10490  11794  14140  12839   8233   5292   3536   3044      0]]
2022-05-08 10:50:18,981 - INFO - Epoch: 5 | Validation Loss: 94.2444
2022-05-08 11:07:11,924 - INFO - Custom bins confusion matrix:
2022-05-08 11:07:11,924 - INFO - [[1046700  824417  130970   48516   22562   11545    6589    3783    6678
     1243]
 [ 372262  555876  157524   70397   35184   18538   10337    6259   10278
     1796]
 [ 150497  318191  129803   68683   37128   20877   12238    7450   12799
     2327]
 [  68631  187386  100668   59178   34435   19797   12179    7504   13646
     2606]
 [  35363  115827   75548   49269   29895   18209   11247    7264   13834
     2820]
 [  20432   74695   56738   40564   26058   16282   10366    6754   13307
     2859]
 [  12180   50208   44138   33315   22213   14459    9278    6289   12383
     2977]
 [   7376   33876   34345   27519   19018   12738    8440    5657   11946
     2826]
 [  15552   83574   99471   88628   66271   46757   33194   23056   51340
    13983]
 [   5238   32153   47971   51834   44821   35327   26914   20180   52571
    19819]]
2022-05-08 11:07:18,069 - INFO - Epoch: 6 | Train Loss: 90.2132
2022-05-08 11:10:20,539 - INFO - Custom bins confusion matrix:
2022-05-08 11:10:20,539 - INFO - [[218487 169907  35522  13618   6138   2989   1695    862    707     17]
 [ 75788 111159  38001  19047   9817   4927   2383   1148    954     18]
 [ 31403  62349  28919  17657  10387   5715   2437   1404   1114      7]
 [ 15436  36303  20318  14809   9565   5160   2709   1286   1177     24]
 [  8292  21847  15084  12193   8373   4685   2672   1253   1124     19]
 [  5102  14963  11354   9656   7058   4150   2460   1211   1194      0]
 [  3384   9872   8616   7537   6146   3775   2035    956   1139      0]
 [  2328   7098   6672   6055   5264   3480   2011    899    818      0]
 [  4990  18816  20142  22119  19515  12342   6692   3508   3072      0]
 [  2590  10148  11889  13922  12233   8624   4965   3757   3560      0]]
2022-05-08 11:10:22,367 - INFO - Epoch: 6 | Validation Loss: 94.0485
2022-05-08 11:27:19,812 - INFO - Custom bins confusion matrix:
2022-05-08 11:27:19,813 - INFO - [[1059049  816984  129433   47481   21577   11109    6103    3647    6344
     1276]
 [ 375422  555644  156734   69759   34443   18283   10345    5906   10076
     1839]
 [ 150296  318926  130229   68440   36939   20633   11851    7234   13009
     2436]
 [  68437  187149  100543   59528   34045   20250   12121    7461   13787
     2709]
 [  34766  115377   75789   48983   30197   18388   11495    7217   14073
     2991]
 [  19718   74541   56673   40637   25968   16477   10317    6993   13572
     3159]
 [  11940   49025   44155   33687   22266   14571    9381    6305   12859
     3251]
 [   7013   33169   33967   27415   19294   12933    8555    5750   12297
     3348]
 [  14782   80875   97723   87615   66698   47547   33294   23328   53822
    16142]
 [   5090   30070   45567   50101   43498   35324   27430   20638   55852
    23258]]
2022-05-08 11:27:25,909 - INFO - Epoch: 7 | Train Loss: 88.9365
2022-05-08 11:30:32,103 - INFO - Custom bins confusion matrix:
2022-05-08 11:30:32,103 - INFO - [[217854 172837  33460  12801   6287   3116   1683    893    998     13]
 [ 75431 113357  35922  17949  10072   5258   2742   1226   1260     25]
 [ 31424  63856  27020  16847  10350   6061   2898   1405   1523      8]
 [ 15627  37395  18869  14015   9615   5612   2781   1439   1403     31]
 [  8505  22645  14239  11143   8394   5070   2624   1522   1382     18]
 [  5160  15702  10618   8711   7198   4285   2687   1447   1340      0]
 [  3476  10410   7895   6965   6246   3776   2374   1063   1255      0]
 [  2415   7464   6263   5748   5085   3482   2086   1026   1056      0]
 [  5282  19921  19280  20010  18395  12630   7712   4210   3756      0]
 [  2613  10556  11369  13023  12020   8146   5593   4130   4238      0]]
2022-05-08 11:30:33,705 - INFO - Epoch: 7 | Validation Loss: 94.2673
2022-05-08 11:47:27,807 - INFO - Custom bins confusion matrix:
2022-05-08 11:47:27,807 - INFO - [[1076182  805307  126626   46480   21048   10731    5774    3598    6025
     1232]
 [ 381718  551495  156865   69228   34085   17535    9965    5802    9850
     1908]
 [ 152040  315862  131448   68867   36942   20537   11931    7122   12800
     2444]
 [  68601  184591  101868   59881   34290   20139   12162    7529   14039
     2930]
 [  34423  113227   76845   49450   30238   18346   11706    7449   14401
     3191]
 [  19294   72565   57614   40678   25866   16561   10763    7010   14210
     3494]
 [  11482   47680   44389   33282   22497   14529    9698    6592   13569
     3722]
 [   6694   32217   33772   27158   19530   12865    8773    6111   12935
     3686]
 [  13975   76336   95723   87183   66618   47541   33900   24364   57264
    18922]
 [   4384   27535   43346   48348   43062   34793   27686   21197   59342
    27135]]
2022-05-08 11:47:33,822 - INFO - Epoch: 8 | Train Loss: 87.4688
2022-05-08 11:50:37,345 - INFO - Custom bins confusion matrix:
2022-05-08 11:50:37,346 - INFO - [[223192 165776  33538  13390   6574   3451   1929    967   1082     43]
 [ 78089 109272  36166  18522   9922   5508   2829   1462   1444     28]
 [ 33098  60970  27203  17273  10247   6277   3041   1575   1704      4]
 [ 16556  35624  18882  14309   9424   5627   3156   1610   1574     25]
 [  9011  21470  14214  11577   7883   5230   3020   1622   1493     22]
 [  5541  14869  10854   9130   6444   4463   2682   1687   1478      0]
 [  3686   9910   8033   7310   5630   3907   2364   1282   1334      4]
 [  2479   7092   6519   5771   4860   3527   2131   1090   1155      1]
 [  5588  19129  18979  20538  16940  13378   8104   4320   4217      3]
 [  2943  10170  11685  12925  11443   7747   5959   3840   4976      0]]
2022-05-08 11:50:38,968 - INFO - Epoch: 8 | Validation Loss: 94.5384
2022-05-08 12:07:30,351 - INFO - Custom bins confusion matrix:
2022-05-08 12:07:30,352 - INFO - [[1090387  795222  125423   44798   20571   10403    5671    3402    5978
     1148]
 [ 386264  549910  156289   68236   33326   17449    9728    5737    9744
     1768]
 [ 152791  315438  132218   68628   36458   20391   11703    7115   12715
     2536]
 [  68025  184493  102374   59860   34566   19995   12060    7761   13844
     3052]
 [  34303  112783   77103   49534   30033   18243   11667    7596   14604
     3410]
 [  18956   71695   58009   40928   26228   16590   10528    7069   14341
     3711]
 [  11071   46561   44533   33975   22749   14926    9642    6392   13835
     3756]
 [   6338   31318   33543   27713   19698   13067    8785    6007   13200
     4072]
 [  13065   73380   93747   87049   66857   48133   34592   24526   59734
    20743]
 [   4018   25229   41217   46287   42062   34569   27668   21821   62437
    31520]]
2022-05-08 12:07:36,230 - INFO - Epoch: 9 | Train Loss: 86.2471
2022-05-08 12:10:40,871 - INFO - Custom bins confusion matrix:
2022-05-08 12:10:40,872 - INFO - [[226175 163551  33359  12842   6328   3601   1820   1006   1213     47]
 [ 79707 108572  35210  17972   9767   5545   3031   1593   1787     58]
 [ 33740  61600  26091  16207  10261   6350   3478   1560   2074     31]
 [ 16961  36024  18389  13506   9253   5737   3338   1709   1835     35]
 [  9360  21965  13530  10838   7908   5173   3252   1731   1734     51]
 [  5740  15203  10403   8165   6666   4685   2963   1742   1573      8]
 [  3813  10120   7808   6705   5681   3855   2633   1368   1477      0]
 [  2576   7474   6208   5169   4868   3505   2318   1255   1251      1]
 [  5842  19660  18499  19063  17664  12608   7899   4728   5175     58]
 [  3128  10850  11649  11304  11194   7267   6073   4186   6007     30]]
2022-05-08 12:10:42,409 - INFO - Epoch: 9 | Validation Loss: 94.6260
2022-05-08 12:10:42,414 - INFO - Experiment ended. Checkpoints stored =)
